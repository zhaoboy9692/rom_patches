From 029b6c514e092da27920e091e8c37946b869b293 Mon Sep 17 00:00:00 2001
From: Yumi Yukimura <me.cafebabe@gmail.com>
Date: Wed, 24 Jul 2024 04:02:57 +0800
Subject: [PATCH] sepolicy: Label iso9660 and udf filesystem

Change-Id: I2413b088558448b86200061cb298f395717c372e
---
 common/private/genfs_contexts | 3 +++
 common/public/file.te         | 2 ++
 2 files changed, 5 insertions(+)
 create mode 100644 common/public/file.te

diff --git a/common/private/genfs_contexts b/common/private/genfs_contexts
index d096874..57f7e0e 100644
--- a/common/private/genfs_contexts
+++ b/common/private/genfs_contexts
@@ -1,2 +1,5 @@
 genfscon sysfs /devices/virtual/timed_output/vibrator u:object_r:sysfs_vibrator:s0
 genfscon sysfs /module/mmcblk/parameters/perdev_minors u:object_r:sysfs_perdev_minors:s0
+
+genfscon iso9660 / u:object_r:iso9660:s0
+genfscon udf / u:object_r:udf:s0
diff --git a/common/public/file.te b/common/public/file.te
new file mode 100644
index 0000000..00c194d
--- /dev/null
+++ b/common/public/file.te
@@ -0,0 +1,2 @@
+type iso9660, sdcard_type, fs_type, mlstrustedobject;
+type udf, sdcard_type, fs_type, mlstrustedobject;
-- 
2.39.2

